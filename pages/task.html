<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Aina Global – Tasks</title>
  <link rel="stylesheet" href="../css/style.css">
  <script src="../js/app.js" defer></script>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js"></script>
</head>
<body>

  <div class="tasks-container" style="max-width:500px;margin:auto;padding:20px;">
    <h2 style="text-align:center;color:#0a3cff;">Your Tasks</h2>

    <div class="task-list" id="taskList" style="margin-top:20px;display:flex;flex-direction:column;gap:15px;">
      <!-- Tasks dynamically add honge -->
      // Step 14 – Task List + Complete Task

const tasks = [
  {name: "Watch YouTube Video", BV: 10, IP: 1},
  {name: "Play Game", BV: 20, IP: 2},
  {name: "Download App", BV: 15, IP: 1}
];

// Show tasks dynamically
firebase.auth().onAuthStateChanged(function(user) {
  if(user){
    const uid = user.uid;
    const taskList = document.getElementById("taskList");
    taskList.innerHTML = "";

    tasks.forEach(task => {
      const div = document.createElement("div");
      div.style.padding = "10px";
      div.style.border = "1px solid #0a3cff";
      div.style.borderRadius = "5px";

      div.innerHTML = `
        <p>${task.name}</p>
        <button style="width:100%;padding:8px;margin-top:5px;background:#0a3cff;color:white;border:none;border-radius:5px;"
          onclick="completeTask('${uid}','${task.name}',${task.BV},${task.IP})">
          Complete Task
        </button>
      `;
      taskList.appendChild(div);
    });
  } else {
    window.location.href = "login.html";
  }
});

// Complete Task function
function completeTask(userId, taskName, BV, IP){
  // Firebase me mark as completed
  firebase.database().ref('users/' + userId + '/tasks/' + taskName).set('completed');

  // Update BV, IP and Level
  firebase.database().ref('users/' + userId).transaction(user => {
    if(user){
      user.BV += BV;
      user.IP += IP;
      if(user.IP >= 3600) user.level = 8;
      else if(user.IP >= 1800) user.level = 7;
      else if(user.IP >= 600) user.level = 6;
      else if(user.IP >= 160) user.level = 5;
      else if(user.IP >= 40) user.level = 4;
      else user.level = 3;
    }
    return user;
  });

  alert(taskName + " Completed!");
}
    </div>

  </div>

</body>
</html>
